<html lang="zh-CN"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>圆之交汇 绘图器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        neutral: '#F3F4F6',
                        dark: '#1F2937'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .canvas-container {
                @apply bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden;
            }
            .input-section {
                @apply bg-white rounded-lg shadow-lg border border-gray-200 p-5 h-full;
            }
            .btn {
                @apply px-4 py-2 rounded-lg font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2;
            }
            .btn-primary {
                @apply bg-primary text-white hover:bg-primary/90 focus:ring-primary/50;
            }
            .btn-secondary {
                @apply bg-secondary text-white hover:bg-secondary/90 focus:ring-secondary/50;
            }
            .btn-outline {
                @apply border border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-gray-200;
            }
            .control-panel {
                @apply grid grid-cols-2 gap-3 mb-4;
            }
            .control-label {
                @apply text-sm font-medium text-gray-700 mb-1;
            }
            .control-input {
                @apply w-full p-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary;
            }
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:Inter, system-ui, sans-serif;font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0px}.col-span-2{grid-column:span 2 / span 2}.mx-auto{margin-left:auto;margin-right:auto}.mb-1{margin-bottom:0.25rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-8{margin-bottom:2rem}.ml-2{margin-left:0.5rem}.mr-1{margin-right:0.25rem}.mr-2{margin-right:0.5rem}.mt-1{margin-top:0.25rem}.mt-12{margin-top:3rem}.mt-2{margin-top:0.5rem}.mt-4{margin-top:1rem}.block{display:block}.flex{display:flex}.inline-flex{display:inline-flex}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-3{height:0.75rem}.h-40{height:10rem}.h-5{height:1.25rem}.h-full{height:100%}.min-h-screen{min-height:100vh}.w-3{width:0.75rem}.w-5{width:1.25rem}.w-full{width:100%}.max-w-2xl{max-width:42rem}.max-w-7xl{max-width:80rem}.flex-1{flex:1 1 0%}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-6{gap:1.5rem}.gap-x-6{column-gap:1.5rem}.gap-y-2{row-gap:0.5rem}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.rounded{border-radius:0.25rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-t{border-top-width:1px}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-red-400{--tw-border-opacity:1;border-color:rgb(248 113 113 / var(--tw-border-opacity, 1))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-primary{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-red-50{--tw-bg-opacity:1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.bg-secondary{--tw-bg-opacity:1;background-color:rgb(16 185 129 / var(--tw-bg-opacity, 1))}.bg-white\/80{background-color:rgb(255 255 255 / 0.8)}.p-1\.5{padding:0.375rem}.p-3{padding:0.75rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-4{padding-left:1rem;padding-right:1rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.py-8{padding-top:2rem;padding-bottom:2rem}.text-center{text-align:center}.font-sans{font-family:Inter, system-ui, sans-serif}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-\[clamp\(1\.8rem\2c 5vw\2c 2\.5rem\)\]{font-size:clamp(1.8rem,5vw,2.5rem)}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.text-dark{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-primary{--tw-text-opacity:1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-red-700{--tw-text-opacity:1;color:rgb(185 28 28 / var(--tw-text-opacity, 1))}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.canvas-container{overflow:hidden;border-radius:0.5rem;border-width:1px;--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1));--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1));--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.input-section{height:100%;border-radius:0.5rem;border-width:1px;--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1));--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1));padding:1.25rem;--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.btn{border-radius:0.5rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-weight:500;transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:200ms}.btn:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);--tw-ring-offset-width:2px}.btn-primary{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1));--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.btn-primary:hover{background-color:rgb(59 130 246 / 0.9)}.btn-primary:focus{--tw-ring-color:rgb(59 130 246 / 0.5)}.btn-outline{border-width:1px;--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1));--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.btn-outline:hover{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.btn-outline:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(229 231 235 / var(--tw-ring-opacity, 1))}.control-panel{margin-bottom:1rem;display:grid;grid-template-columns:repeat(2, minmax(0, 1fr));gap:0.75rem}.control-label{margin-bottom:0.25rem;font-size:0.875rem;line-height:1.25rem;font-weight:500;--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.control-input{width:100%;border-radius:0.5rem;border-width:1px;--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1));padding:0.5rem}.control-input:focus{--tw-border-opacity:1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1));--tw-ring-opacity:1;--tw-ring-color:rgb(59 130 246 / var(--tw-ring-opacity, 1))}.focus\:border-primary:focus{--tw-border-opacity:1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.focus\:ring-primary:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(59 130 246 / var(--tw-ring-opacity, 1))}@media (min-width: 640px){.sm\:flex-row{flex-direction:row}}@media (min-width: 1024px){.lg\:col-span-1{grid-column:span 1 / span 1}.lg\:col-span-2{grid-column:span 2 / span 2}.lg\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}}
    </style></head>
<body class="bg-gray-50 font-sans text-dark min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- 标题区域 -->
        <header class="mb-8 text-center">
            <h1 class="text-[clamp(1.8rem,5vw,2.5rem)] font-bold text-dark mb-2">数据可视化</h1>
            <p class="text-gray-600 max-w-2xl mx-auto">输入多个圆的圆心坐标和半径，在右侧画布中查看绘制效果。支持直接输入或文件导入数据。</p>
        </header>

        <!-- 主要内容区域 -->
        <main class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- 左侧输入区域 -->
            <div class="lg:col-span-1">
                <div class="input-section">
                    <h2 class="text-xl font-semibold mb-4 flex items-center">
                        <i class="fa fa-pencil-square-o mr-2 text-primary"></i>输入数据
                    </h2>
                    
                    <div class="mb-4">
                        <label for="data-input" class="block text-sm font-medium text-gray-700 mb-1">数据格式</label>
                        <p class="text-xs text-gray-500 mb-2">
                            n<br>
                            x1 y1 r1<br>
                            x2 y2 r2<br>
                            ...<br>
                            xn yn rn<br>
                            <span class="text-primary">(n为圆的数量，后面n行为每个圆的圆心坐标和半径)</span>
                        </p>
                    </div>
                    
                    <div class="mb-4">
                        <label for="data-input" class="block text-sm font-medium text-gray-700 mb-1">输入数据</label>
                        <textarea id="data-input" class="w-full h-40 p-3 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary transition-all" placeholder="例如：
3
100 100 50
200 150 30
150 200 40"></textarea>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">或从文件导入</label>
                        <div class="flex items-center">
                            <input type="file" id="file-input" class="hidden" accept=".txt">
                            <button id="browse-file" class="btn btn-outline mr-2 flex items-center">
                                <i class="fa fa-file-text-o mr-1"></i> 选择文件
                            </button>
                            <span id="file-name" class="text-sm text-gray-500 flex-1 truncate">未选择文件</span>
                        </div>
                    </div>
                    
                    <!-- 新增的绘图设置 -->
                    <div class="mb-4">
                        <h3 class="text-lg font-medium mb-3 flex items-center">
                            <i class="fa fa-sliders mr-2 text-primary"></i>绘图设置
                        </h3>
                        
                        <div class="control-panel">
                            <div class="col-span-2">
                                <label for="stroke-width" class="control-label">画笔粗细 (支持 1e-9 到 1e9)</label>
                                <input type="text" id="stroke-width" value="2" class="control-input" placeholder="输入数值或科学计数法，如 1e-6">
                                <div class="mt-1 flex justify-between">
                                    <button id="decrease-stroke" class="btn btn-outline px-2 py-1 text-sm">
                                        <i class="fa fa-minus"></i>
                                    </button>
                                    <button id="increase-stroke" class="btn btn-outline px-2 py-1 text-sm">
                                        <i class="fa fa-plus"></i>
                                    </button>
                                    <button id="reset-stroke" class="btn btn-outline px-2 py-1 text-sm">
                                        <i class="fa fa-refresh"></i> 重置
                                    </button>
                                </div>
                            </div>
                            
                            <div>
                                <label for="show-info" class="control-label">显示圆信息</label>
                                <div class="mt-2">
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" id="show-info" class="form-checkbox h-5 w-5 text-primary rounded" checked="">
                                        <span class="ml-2 text-gray-700">显示坐标和半径</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div>
                                <label for="log-scale" class="control-label">对数缩放</label>
                                <div class="mt-2">
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" id="log-scale" class="form-checkbox h-5 w-5 text-primary rounded">
                                        <span class="ml-2 text-gray-700">适合大范围半径</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div>
                                <label for="circle-color" class="control-label">圆颜色</label>
                                <input type="color" id="circle-color" value="#3B82F6" class="control-input h-10">
                            </div>
                            
                            <div>
                                <label for="center-color" class="control-label">圆心颜色</label>
                                <input type="color" id="center-color" value="#10B981" class="control-input h-10">
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex flex-col sm:flex-row gap-3">
                        <button id="draw-button" class="btn btn-primary flex-1 flex items-center justify-center">
                            <i class="fa fa-paint-brush mr-2"></i>绘制圆
                        </button>
                        <button id="clear-button" class="btn btn-outline flex-1 flex items-center justify-center">
                            <i class="fa fa-eraser mr-2"></i>清除
                        </button>
                    </div>
                    
                    <div id="error-message" class="mt-4 hidden">
                        <div class="bg-red-50 border border-red-400 text-red-700 px-4 py-3 rounded-lg text-sm">
                            <i class="fa fa-exclamation-triangle mr-1"></i>
                            <span id="error-text">请检查输入格式是否正确</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 右侧画布区域 -->
            <div class="lg:col-span-2">
                <div class="canvas-container">
                    <div class="bg-gray-100 p-3 border-b border-gray-200 flex justify-between items-center">
                        <h2 class="text-xl font-semibold flex items-center">
                            <i class="fa fa-area-chart mr-2 text-primary"></i>绘制结果
                        </h2>
                        <div class="flex gap-2">
                            <button id="zoom-in" class="btn btn-outline p-1.5">
                                <i class="fa fa-search-plus"></i>
                            </button>
                            <button id="zoom-out" class="btn btn-outline p-1.5">
                                <i class="fa fa-search-minus"></i>
                            </button>
                            <button id="reset-view" class="btn btn-outline p-1.5">
                                <i class="fa fa-refresh"></i>
                            </button>
                        </div>
                    </div>
                    <div class="p-3">
                        <div class="relative" style="height: 600px;">
                            <canvas id="circle-canvas" class="w-full h-full border border-gray-200 rounded" width="799" height="600"></canvas>
                            <div id="canvas-overlay" class="absolute inset-0 bg-white/80 flex items-center justify-center">
                                <div class="text-center">
                                    <i class="fa fa-info-circle text-4xl text-gray-400 mb-2"></i>
                                    <p class="text-gray-600">请输入数据并点击"绘制圆"按钮</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-gray-100 p-3 border-t border-gray-200 text-sm text-gray-600">
                        <div class="flex flex-wrap gap-x-6 gap-y-2">
                            <div class="flex items-center">
                                <div class="w-3 h-3 rounded-full bg-primary mr-2"></div>
                                <span>圆边界</span>
                            </div>
                            <div class="flex items-center">
                                <div class="w-3 h-3 rounded-full bg-secondary mr-2"></div>
                                <span>圆心</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fa fa-search-plus text-gray-700 mr-1"></i>
                                <i class="fa fa-search-minus text-gray-700 mr-1"></i>
                                <span>缩放视图</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- 页脚 -->
        <footer class="mt-12 text-center text-gray-500 text-sm">
            <p>© 2025 圆绘制应用 | 使用 HTML, CSS 和 JavaScript 构建</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('页面已加载'); // 调试日志
            
            // 获取DOM元素
            const canvas = document.getElementById('circle-canvas');
            const ctx = canvas.getContext('2d');
            const dataInput = document.getElementById('data-input');
            const fileInput = document.getElementById('file-input');
            const browseFileBtn = document.getElementById('browse-file');
            const fileNameSpan = document.getElementById('file-name');
            const drawButton = document.getElementById('draw-button');
            const clearButton = document.getElementById('clear-button');
            const errorMessage = document.getElementById('error-message');
            const errorText = document.getElementById('error-text');
            const canvasOverlay = document.getElementById('canvas-overlay');
            const zoomInBtn = document.getElementById('zoom-in');
            const zoomOutBtn = document.getElementById('zoom-out');
            const resetViewBtn = document.getElementById('reset-view');
            
            // 新增的绘图设置元素
            const strokeWidth = document.getElementById('stroke-width');
            const decreaseStrokeBtn = document.getElementById('decrease-stroke');
            const increaseStrokeBtn = document.getElementById('increase-stroke');
            const resetStrokeBtn = document.getElementById('reset-stroke');
            const showInfo = document.getElementById('show-info');
            const logScale = document.getElementById('log-scale');
            const circleColor = document.getElementById('circle-color');
            const centerColor = document.getElementById('center-color');
            
            // 初始化变量
            let circles = [];
            let scale = 1;
            let offsetX = 0;
            let offsetY = 0;
            let isDragging = false;
            let lastX, lastY;
            let defaultStrokeWidth = 2;
            
            // 显示初始覆盖层
            canvasOverlay.classList.remove('hidden');
            
            // 设置canvas尺寸
            function resizeCanvas() {
                const container = canvas.parentElement;
                canvas.width = container.clientWidth;
                canvas.height = container.clientHeight;
                console.log(`画布大小已调整为: ${canvas.width} x ${canvas.height}`); // 调试日志
                
                // 只有当有圆数据时才重新绘制
                if (circles && circles.length > 0) {
                    redrawCircles();
                }
            }
            
            // 解析数值输入，支持科学计数法
            function parseNumber(value) {
                try {
                    const num = parseFloat(value);
                    if (isNaN(num)) throw new Error('无效数值');
                    return num;
                } catch (e) {
                    console.error('解析数值失败:', e);
                    showError('请输入有效的数值或科学计数法格式，如 1e-6');
                    return null;
                }
            }
            
            // 绘制所有圆
            function drawCircles() {
                console.log('绘制圆: 数量=' + circles.length); // 调试日志
                
                // 清除画布
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // 如果没有圆，直接返回
                if (circles.length === 0) return;
                
                // 应用变换
                ctx.save();
                ctx.scale(scale, scale);
                ctx.translate(offsetX / scale, offsetY / scale);
                
                // 获取当前绘图设置
                const strokeWidthValue = parseNumber(strokeWidth.value);
                if (strokeWidthValue === null) return;
                
                const shouldShowInfo = showInfo.checked;
                const useLogScale = logScale.checked;
                const currentCircleColor = circleColor.value;
                const currentCenterColor = centerColor.value;
                
                // 绘制所有圆
                circles.forEach(circle => {
                    // 根据对数缩放选项调整显示大小
                    let displayRadius = circle.r;
                    if (useLogScale && circle.r > 0) {
                        // 使用对数缩放，使大范围的半径能在画布上合理显示
                        // 这里使用自然对数，但可以根据需要调整
                        displayRadius = Math.log(circle.r + 1);
                    }
                    
                    // 绘制圆
                    ctx.beginPath();
                    ctx.arc(circle.x, circle.y, displayRadius, 0, Math.PI * 2);
                    ctx.strokeStyle = currentCircleColor;
                    ctx.lineWidth = strokeWidthValue;
                    ctx.stroke();
                    
                    // 绘制圆心，大小与画笔粗细相同
                    ctx.beginPath();
                    ctx.arc(circle.x, circle.y, strokeWidthValue, 0, Math.PI * 2);
                    ctx.fillStyle = currentCenterColor;
                    ctx.fill();
                    
                    // 根据设置决定是否显示圆信息
                    if (shouldShowInfo) {
                        ctx.fillStyle = '#1F2937'; // 深色文本
                        ctx.font = '12px Arial';
                        ctx.fillText(`(${circle.x.toFixed(1)}, ${circle.y.toFixed(1)}) r=${circle.r.toExponential(3)}`, 
                                    circle.x + displayRadius + 5, circle.y);
                    }
                });
                
                // 恢复变换
                ctx.restore();
                
                console.log('圆绘制完成'); // 调试日志
            }
            
            // 重新绘制圆（用于窗口调整大小）
            function redrawCircles() {
                if (circles.length > 0) {
                    console.log('重新绘制圆（窗口大小变化）'); // 调试日志
                    drawCircles();
                }
            }
            
            // 初始调整画布大小
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            // 画笔粗细调整事件
            decreaseStrokeBtn.addEventListener('click', function() {
                const current = parseNumber(strokeWidth.value) || defaultStrokeWidth;
                let newValue = current / 2;
                strokeWidth.value = newValue.toExponential(9).replace(/e\+?/, 'e');
                if (circles.length > 0) {
                    drawCircles();
                }
            });
            
            increaseStrokeBtn.addEventListener('click', function() {
                const current = parseNumber(strokeWidth.value) || defaultStrokeWidth;
                let newValue = current * 2;
                strokeWidth.value = newValue.toExponential(9).replace(/e\+?/, 'e');
                if (circles.length > 0) {
                    drawCircles();
                }
            });
            
            resetStrokeBtn.addEventListener('click', function() {
                strokeWidth.value = defaultStrokeWidth;
                if (circles.length > 0) {
                    drawCircles();
                }
            });
            
            // 输入框变更事件
            strokeWidth.addEventListener('change', function() {
                if (circles.length > 0) {
                    drawCircles();
                }
            });
            
            // 显示信息变化事件
            showInfo.addEventListener('change', function() {
                if (circles.length > 0) {
                    drawCircles();
                }
            });
            
            // 对数缩放变化事件
            logScale.addEventListener('change', function() {
                if (circles.length > 0) {
                    resetView();
                    drawCircles();
                }
            });
            
            // 圆颜色变化事件
            circleColor.addEventListener('change', function() {
                if (circles.length > 0) {
                    drawCircles();
                }
            });
            
            // 圆心颜色变化事件
            centerColor.addEventListener('change', function() {
                if (circles.length > 0) {
                    drawCircles();
                }
            });
            
            // 浏览文件按钮点击事件
            browseFileBtn.addEventListener('click', function() {
                console.log('浏览文件按钮被点击'); // 调试日志
                fileInput.click();
            });
            
            // 文件选择事件
            fileInput.addEventListener('change', function(e) {
                console.log('文件选择事件触发'); // 调试日志
                const file = e.target.files[0];
                if (file) {
                    fileNameSpan.textContent = file.name;
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        console.log('文件内容已加载'); // 调试日志
                        dataInput.value = e.target.result;
                    };
                    reader.readAsText(file);
                }
            });
            
            // 绘制按钮点击事件
            drawButton.addEventListener('click', function() {
                console.log('绘制按钮被点击'); // 调试日志
                
                try {
                    const input = dataInput.value.trim();
                    if (!input) {
                        showError('请输入数据');
                        return;
                    }
                    
                    const lines = input.split('\n').filter(line => line.trim() !== '');
                    if (lines.length < 2) {
                        showError('输入格式不正确，至少需要两行数据');
                        return;
                    }
                    
                    const n = parseInt(lines[0]);
                    if (isNaN(n) || n <= 0 || n !== Math.floor(n)) {
                        showError('第一行必须是一个正整数，表示圆的数量');
                        return;
                    }
                    
                    if (lines.length !== n + 1) {
                        showError(`需要${n + 1}行数据（1行圆的数量，${n}行圆的信息）`);
                        return;
                    }
                    
                    circles = [];
                    for (let i = 1; i <= n; i++) {
                        const parts = lines[i].trim().split(/\s+/);
                        if (parts.length !== 3) {
                            showError(`第${i + 1}行格式不正确，需要3个数值（x, y, r）`);
                            return;
                        }
                        
                        const x = parseFloat(parts[0]);
                        const y = parseFloat(parts[1]);
                        const r = parseFloat(parts[2]);
                        
                        if (isNaN(x) || isNaN(y) || isNaN(r) || r <= 0) {
                            showError(`第${i + 1}行包含无效数值，半径必须是正数`);
                            return;
                        }
                        
                        circles.push({ x, y, r });
                    }
                    
                    console.log(`成功解析${circles.length}个圆`); // 调试日志
                    console.log('圆数据:', circles); // 调试日志
                    
                    hideError();
                    canvasOverlay.classList.add('hidden');
                    resetView();
                    drawCircles();
                } catch (error) {
                    console.error('处理数据时出错:', error); // 调试日志
                    showError('处理数据时出错: ' + error.message);
                }
            });
            
            // 清除按钮点击事件
            clearButton.addEventListener('click', function() {
                console.log('清除按钮被点击'); // 调试日志
                dataInput.value = '';
                fileNameSpan.textContent = '未选择文件';
                fileInput.value = '';
                circles = [];
                resetView();
                canvasOverlay.classList.remove('hidden');
                drawCircles();
                hideError();
            });
            
            // 缩放和重置按钮事件
            zoomInBtn.addEventListener('click', function() {
                console.log('放大按钮被点击'); // 调试日志
                scale *= 1.2;
                drawCircles();
            });
            
            zoomOutBtn.addEventListener('click', function() {
                console.log('缩小按钮被点击'); // 调试日志
                scale /= 1.2;
                drawCircles();
            });
            
            resetViewBtn.addEventListener('click', resetView);
            
            // 重置视图
            function resetView() {
                console.log('重置视图'); // 调试日志
                scale = 1;
                
                if (circles.length > 0) {
                    // 计算所有圆的边界框
                    let minX = Infinity, minY = Infinity;
                    let maxX = -Infinity, maxY = -Infinity;
                    
                    const useLogScale = logScale.checked;
                    
                    circles.forEach(circle => {
                        let displayRadius = circle.r;
                        if (useLogScale && circle.r > 0) {
                            displayRadius = Math.log(circle.r + 1);
                        }
                        
                        minX = Math.min(minX, circle.x - displayRadius);
                        minY = Math.min(minY, circle.y - displayRadius);
                        maxX = Math.max(maxX, circle.x + displayRadius);
                        maxY = Math.max(maxY, circle.y + displayRadius);
                    });
                    
                    const width = maxX - minX;
                    const height = maxY - minY;
                    const padding = 50;
                    
                    // 计算适应画布的缩放比例
                    const scaleX = (canvas.width - padding * 2) / width;
                    const scaleY = (canvas.height - padding * 2) / height;
                    scale = Math.min(scaleX, scaleY, 1); // 不超过原始大小
                    
                    // 计算偏移量，使所有圆居中
                    const centerX = (minX + maxX) / 2;
                    const centerY = (minY + maxY) / 2;
                    offsetX = canvas.width / 2 - centerX * scale;
                    offsetY = canvas.height / 2 - centerY * scale;
                    
                    console.log(`视图重置: scale=${scale}, offset=(${offsetX}, ${offsetY})`); // 调试日志
                } else {
                    offsetX = 0;
                    offsetY = 0;
                }
                
                drawCircles();
            }
            
            // 画布拖动功能
            canvas.addEventListener('mousedown', function(e) {
                if (circles.length === 0) return;
                
                console.log('开始拖动画布'); // 调试日志
                isDragging = true;
                lastX = e.clientX;
                lastY = e.clientY;
                canvas.style.cursor = 'grabbing';
            });
            
            window.addEventListener('mousemove', function(e) {
                if (!isDragging) return;
                
                const deltaX = e.clientX - lastX;
                const deltaY = e.clientY - lastY;
                offsetX += deltaX;
                offsetY += deltaY;
                lastX = e.clientX;
                lastY = e.clientY;
                
                console.log(`拖动画布: delta=(${deltaX}, ${deltaY}), offset=(${offsetX}, ${offsetY})`); // 调试日志
                drawCircles();
            });
            
            window.addEventListener('mouseup', function() {
                if (isDragging) {
                    console.log('结束拖动画布'); // 调试日志
                    isDragging = false;
                    canvas.style.cursor = 'default';
                }
            });
            
            // 显示错误信息
            function showError(message) {
                console.log('显示错误:', message); // 调试日志
                errorText.textContent = message;
                errorMessage.classList.remove('hidden');
                // 滚动到错误信息
                errorMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
            
            // 隐藏错误信息
            function hideError() {
                console.log('隐藏错误信息'); // 调试日志
                errorMessage.classList.add('hidden');
            }
            
            // 添加示例数据
            dataInput.value = "3\n100 100 50\n200 150 30\n150 200 40";
        });
    </script>


    </body></html>
